#include <stdio.h>
#include <stdlib.h>

typedef int* Statistician;

int input(int number)
{	
	while(number < 1 || number > 9)
	{
		scanf("%d", &number);
		
		//Checks if number is 1-9
		if(number < 1 || number > 9)
		{
			printf("Number must be 1-9\n");
		}
	}

	return number;
}

void add(Statistician answer, int *count, int *SIZE, int item)
{
	//Doubling the size	
	if((*count-1) > (*SIZE-1))
	{
		(*SIZE) *= 2;
		answer = (Statistician)realloc(answer, (*SIZE)*sizeof(int));
	}
	
	answer[(*count)] = item;
	(*count)++;
	
	int i;
	//Sorting
	for(i = 0; i < (*count)-1; i++)
	{
		int j;
		for(j = i + 1; j < (*count); j++)
		{
			if(answer[i] > answer[j])
			{
				int temp = answer[j];
				answer[j] = answer[i];
				answer[i] = temp;
			}
		}
	}
}

float mean(Statistician answer, int count)
{
	float mean = 0, temp;
	int i; 
		
	for(i = 0; i < count; i++)
	{
		temp += answer[i];
	}
	
	mean = (float)temp/count;

	return mean;
}

float median(Statistician answer, int count)
{
	float median = 0;
	int i;
	
	if(count % 2 == 0)
	{
		float temp = answer[(count / 2) - 1] + answer[((count + 2)/2) - 1];
		median = temp/2;
	}
	else
		median = answer[count/2];
		
	return median;
}

int max(Statistician answer, int count)
{
	int max = answer[count-1];
	
	return max;
}

int min(Statistician answer, int count)
{
	int min = answer[0];
	
	return min;
}

int range(Statistician answer, int count)
{
	int range = answer[count - 1] - answer[0];
		
	return range;
}

void mode(int freq[], int *freqsize, Statistician answer, int count)
{
	int i, j;
	*freqsize = 0;
	int tempSize = 9;
	
	int tempFreq[tempSize];

   for (i = 0; i < tempSize; i++) 
   {
      tempFreq[i] = 0;
	}	
    
	for (i = 0; i < tempSize; i++) 
	{
		for(j = 0; j < count; j++)
		{
			if(i + 1 == answer[j])
				tempFreq[i] += 1;
		}     
      }
    
	  int max = tempFreq[0];
	  for(i = 1; i < tempSize; i++)
	  {
	  	if(tempFreq[i] > max)
	  		max = tempFreq[i];
	  }
	  
	  for(i = 0; i < tempSize; i++)
	  {
	  	if(tempFreq[i] == max)
	  	{
	  		freq[*freqsize] = i + 1;
	  		(*freqsize)++;
	  		freq = (Statistician)realloc(freq, (*freqsize)*sizeof(int));
		}
	  }
}

void histogram(Statistician answer, int count)
{
	int i, j;
	int temp;
	
	printf("Histogram");
	for(i = 1; i < 10; i++)
	{        
		printf("\n%4d: ", i);
		
		for(j = 0; j < count; j++)
		{
			if(i == answer[j])
			printf("*");
		}
	}
}

int main()
{
	Statistician answer;
	int count = 0, item, i, freqsize = 0, number;
	char x;
	int SIZE = 10;
	
	answer = (Statistician)malloc(SIZE * sizeof(int));
	int *freq = (int*)malloc(freqsize * sizeof(int));
	
	while(1) 
	{
		system("cls");
		
		while(count < 10)
		{
			printf("Answer: ", count+1);
			item = input(number);
			add(answer, &count, &SIZE, item);
			system("cls");
		}
		printf("Responds: %d", count);
		printf("\nResponses:\n");
		
		for(i = 0; i < count; i++)
		{
			if(i == count - 1)
				printf("%d\n", answer[i]);
			else
				printf("%d\n", answer[i]);
		}
		
		printf("Statistician Menu\n\n");
		printf("[1] Add\n");
		printf("[2] Mean\n");
		printf("[3] Median\n");
		printf("[4] Max\n");
		printf("[5] Min\n");                
		printf("[6] Range\n");
		printf("[7] Mode\n");
		printf("[8] Histogram\n\n");
		printf("Enter choice: ");
		int choice;	scanf("%d", &choice);
		
		switch(choice)
		{
			case 1:
				printf("Enter additional response: ");
				item = input(number);
				add(answer, &count, &SIZE, item);
				break;
			case 2:
				printf("\nMean: %.2f", mean(answer, count));
				getch(x);
				break;
			case 3:
				printf("\nMedian: %.2f", median(answer, count));
				getch(x);
				break;
			case 4:
				printf("\nMax: %d", max(answer, count));
				getch(x);
				break;
				getch(x);
			case 5:
				printf("\nMin: %d", min(answer, count));
				getch(x);
				break;
			case 6:
				printf("\nRange: %d", range(answer, count));
				getch(x);
				break;
			case 7:
				mode(freq, &freqsize, answer, count);
				printf("Mode: ");
				for(i = 0; i < freqsize; i++)
					printf("%d ", freq[i]);
				getch(x);
				break;
				getch(x);
			case 8:
				histogram(answer, count);
				getch(x);
				break;
			default:
				printf("Invalid Input");
				getch(x);
		}
		printf("\n");
		system("pause");
	}
	free(answer);

	return 0;
}
